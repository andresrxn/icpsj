---
import { cn } from '@/utils/theme'
import type { HTMLAttributes } from 'astro/types'
import { cva, type VariantProps } from 'class-variance-authority'
import { ChevronsUpDown } from 'lucide-astro'

export const selectVariants = cva(
  'block rounded-base whitespace-nowrap focus-visible:outline-none ring-base focus-visible:ring focus-visible:ring-offset-2 ring-offset-surface disabled:disabled max-w-full placeholder:text-base-subtler p-4 pl-12 w-fit shadow-sm border-input border scroll-p-0 cursor-pointer font-medium outline-none shrink-0 text-base appearance-none text-body-sm',
  {
    variants: {
      variant: {
        primary: 'bg-surface',
        secondary: 'bg-base-bold'
      },
      size: {
        sm: ' h-32 pr-36',
        base: 'h-36 pr-44',
        lg: 'h-40 pr-52'
      },

      pill: {
        true: 'rounded-full'
      }
    },
    defaultVariants: {
      variant: 'primary',
      size: 'base',
      pill: false
    }
  }
)

export type Props = HTMLAttributes<'select'> & VariantProps<typeof selectVariants>

const { pill, size, class: className, variant, ...props } = Astro.props
---

<div class='relative w-fit text-body-sm'>
  <select class={cn(selectVariants({ variant, pill, size }), className)} {...props}
    ><slot />
  </select>
  <ChevronsUpDown
    class='absolute pointer-events-none top-[50%] -translate-y-[50%] right-8 z-auto size-icon-responsive text-icon-primary'
  />
</div>
